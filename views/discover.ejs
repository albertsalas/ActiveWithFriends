
<%- include('./partials/header.ejs') %>
 

<script src='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css' rel='stylesheet' />
<style>
  #map {
  height: 400px;
  /* The height is 400 pixels */
  width: 100%;
  /* The width is the width of the web page */
}
#marker {
/* background-image: url('https://docs.mapbox.com/mapbox-gl-js/assets/washington-monument.jpg'); */
/* background-size: cover; */
/* width: 50px; */
/* height: 50px; */
/* border-radius: 50%; */
/* cursor: pointer; */
}
.mapboxgl-popup {
max-width: 200px;
}
</style>
<div class="hero is-primary" >
  <%- include('./partials/nav.ejs')  %> 
  <div class="hero-body" style="background-color: rgb(21, 132, 121);">
      <div class="container" style="text-align: center;">
          <h1 class="title">
            Discover
          </h1>
      </div>
  </div>

  <div id='map' style='width: 100%; height: 600px;'></div>

  <div class="tabs is-centered">
    <ul>
      <button class="button is-primary">Streetview</button>
      <button class="button is-primary">Dark</button>
      <button class="button is-primary">Outdoors</button>
      <button class="button is-primary">Satellite</button>
      <button class="button is-primary">Satellite+Streets</button>
    </ul>
  </div>

    
</div>

<pre id="info"></pre>
<script>
  var street = `mapbox://styles/mapbox/streets-v11`;
  var outdoors = `mapbox://styles/mapbox/outdoors-v11`;
  var dark = `mapbox://styles/mapbox/dark-v10`;
  var light = `mapbox://styles/mapbox/light-v10`
  var satellite = `mapbox://styles/mapbox/satellite-v9`;
  var satellite_streets = `mapbox://styles/mapbox/satellite-streets-v11`;
  var startMap = street;
  $("button").on('click', function(){
    console.log($(this).html());

    switch($(this).html()){
      case "Dark": startMap = dark;
              break;
      case "Streetview": startMap = street;
              break;
      case "Outdoors": startMap = outdoors;
              break;
      case "Satellite": startMap = satellite;
              break;
      case "Satellite+Streets": startMap = satellite_streets;
              break;
    }


    var map = new mapboxgl.Map({
      container: 'map', // container id
      style: startMap,
      center: [-96, 37.8], // starting position
      zoom: 4 // starting zoom
    });

    map.addControl(
    new mapboxgl.GeolocateControl({
      positionOptions: {
        enableHighAccuracy: true
      },
      trackUserLocation: true
    })
  );

  });

  mapboxgl.accessToken = 'pk.eyJ1IjoicHJveGlpZSIsImEiOiJja2hjbWx5c2IwM3lkMnJzYnhoMnd4Ym0xIn0.wHtiEywv0rY_zEuDDxvEYQ';
  var map = new mapboxgl.Map({
    container: 'map', // container id
    style: startMap,
    center: [-96, 37.8], // starting position
    zoom: 3 // starting zoom
  });
 
  // Add geolocate control to the map.
  map.addControl(
    new mapboxgl.GeolocateControl({
      positionOptions: {
      enableHighAccuracy: true
      },
      trackUserLocation: true
    })
  );

  var marker = new mapboxgl.Marker()
    .setLngLat([12.550343, 55.665957])
    .addTo(map);



    var popup = new mapboxgl.Popup({ offset: 25 }).setText(
        'Construction on the Washington Monument began in 1848.'
    );

    var el = document.createElement('div');
    el.id = 'marker';

    map.on('click', function (e) {
      document.getElementById('info').innerHTML =
      // e.point is the x, y coordinates of the mousemove event relative
      // to the top-left corner of the map
      JSON.stringify(e.point) +
      '<br />' +
      // e.lngLat is the longitude, latitude geographical position of the event
      JSON.stringify(e.lngLat.wrap());
      
      //el
      var marker = new mapboxgl.Marker()
      .setLngLat([e.lngLat.wrap().lng, e.lngLat.wrap().lat])
      .setPopup(popup)
      .addTo(map);
      });

  

   


</script>

<% if (loggedIn) { %>
  <script>
    var username = '<%- username %>'
    var userId = `<%- userId %>`

    console.log(username, " + ", userId);
  </script>
  <%- include('./partials/chat.ejs') %>
<% } %>



<%- include('./partials/footer.ejs') %>